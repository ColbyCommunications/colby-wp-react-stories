!function(e){function t(n){if(a[n])return a[n].exports;var r=a[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var a={};t.m=e,t.c=a,t.i=function(e){return e},t.d=function(e,a,n){t.o(e,a)||Object.defineProperty(e,a,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var a=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(a,"a",a),a},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=10)}([function(e,t){e.exports=React},function(e,t){e.exports=PropTypes},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.loadStories=void 0;var s=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),l=a(1),u=n(l),c=a(0),d=n(c),f=a(14),m=n(f),p=a(16),h=n(p),g=a(15),y=n(g),v=a(9),b=n(v),C=a(6),E=n(C),_=a(13),P=n(_),w=function(e){function t(e){r(this,t);var a=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={activeCategory:window.COLBY_STORIES_ACTIVE_CATEGORY||"0",fetching:!1,postCategories:{},columnCount:t.setColumnCount(),data:{},searchTerm:"",featuredImages:{},fetchUrl:""},a.fetchPosts=y.default.debounce(a.fetchPosts.bind(a),500),a.renderColumn=a.renderColumn.bind(a),a.getPostsForColumn=a.getPostsForColumn.bind(a),a.renderPost=a.renderPost.bind(a),a.fetchCategories=a.fetchCategories.bind(a),a.renderPostCategories=a.renderPostCategories.bind(a),a.renderBody=a.renderBody.bind(a),a.fetchFeaturedMedia=a.fetchFeaturedMedia.bind(a),a}return i(t,e),s(t,null,[{key:"setColumnCount",value:function(){var e=1;return window.innerWidth>576&&(e=2),window.innerWidth>768&&(e=3),e}}]),s(t,[{key:"componentDidMount",value:function(){var e=this;this.fetchPosts(),window.addEventListener("resize",function(){var a=t.setColumnCount();a!==e.state.columnCount&&e.setState({columnCount:a})})}},{key:"componentDidUpdate",value:function(e,t){var a=this;t.activeCategory!==this.state.activeCategory&&this.fetchPosts(),this.fetchCategories(),(this.state.data[this.state.fetchUrl]?this.state.data[this.state.fetchUrl].posts:[]).forEach(function(e){a.fetchFeaturedMedia(e.featured_media)})}},{key:"getPostsForColumn",value:function(e){var t=this;return this.state.data[this.state.fetchUrl].posts.filter(function(a,n){return n%t.state.columnCount===e})}},{key:"fetchFeaturedMedia",value:function(e){var t=this;if(!(0===e||e in this.state.featuredImages)){var a=window.COLBY_REST_URL+"wp/v2/media/"+e;fetch(a).then(function(e){return!0===e.ok?e.json():null}).then(function(a){var n=Object.assign({},t.state.featuredImages);n[e]=a,t.setState({featuredImages:n})})}}},{key:"fetchCategories",value:function(){var e=this;if(this.state.data[this.state.fetchUrl]){var t=[];if(this.state.data[this.state.fetchUrl].posts.forEach(function(a){a.categories.forEach(function(a){a in e.state.postCategories||-1===t.indexOf(a)&&t.push(a)})}),t.length){var a=window.COLBY_REST_URL+"wp/v2/categories/",n=a+"?exclude=1&per_page=99";fetch(n).then(function(e){return e.json()}).then(function(t){var a=Object.assign({},e.state.postCategories);t.forEach(function(e){a[e.id]=e}),e.setState({postCategories:a})})}}}},{key:"fetchPosts",value:function(){var e=this;this.setState({fetching:!0},function(){var t=e.props.endpoint+"&per_page="+e.props.perPage;"0"!==e.state.activeCategory&&null!==e.state.activeCategory&&(t=t+"&categories="+e.state.activeCategory),e.state.searchTerm.length&&(t=t+"&search="+e.state.searchTerm);var a=1;if(t in e.state.data){if(e.state.data[t].nextPage>e.state.data[t].headers.totalPages)return void e.setState({fetchUrl:t,fetching:!1});a=e.state.data[t].nextPage}var n=void 0;fetch(t+"&page="+a).then(function(e){var t=Number(e.headers.get("X-WP-TOTALPAGES"));return n={totalPages:t},e.json()}).then(function(a){var r=Object.assign({},e.state.data);r[t]?(r[t].posts=r[t].posts.concat(a),r[t].nextPage+=1):r[t]={headers:n,posts:a,nextPage:2},e.setState({data:r,fetchUrl:t,fetching:!1})})})}},{key:"renderBody",value:function(){return this.state.searchTerm.length&&0===this.state.data[this.state.fetchUrl].posts?d.default.createElement("div",{className:P.default.noResultsContainer},"No results for ",d.default.createElement("i",null,this.state.searchTerm)):y.default.range(0,this.state.columnCount).map(this.renderColumn)}},{key:"renderColumn",value:function(e){return d.default.createElement("div",{key:e,className:P.default.column},this.getPostsForColumn(e).map(this.renderPost))}},{key:"renderPostCategories",value:function(e,t){var a=this;return d.default.createElement("div",{className:P.default.categoriesContainer+(t?" hasFeaturedImage":"")},e.map(function(e){if(!(e in a.state.postCategories))return null;var t=a.state.postCategories[e],n=t.id,r=t.name,o=t.meta;return d.default.createElement("div",{className:P.default.categoryButtonContainer,key:n,style:{backgroundColor:o.background_color||"#002878"}},d.default.createElement("a",{href:o.site_url,style:{backgroundColor:o.background_color||"#002878",color:o.color||"#000"},className:P.default.categoryButton+" badge"},r))}))}},{key:"renderPost",value:function(e){var t=null;if(e.featured_media in this.state.featuredImages&&null!==this.state.featuredImages[e.featured_media]&&this.state.featuredImages[e.featured_media].media_details){var a=this.state.featuredImages[e.featured_media].media_details.sizes.large||this.state.featuredImages[e.featured_media].media_details.sizes.medium;t=d.default.createElement("img",{className:"card-img",alt:e.title.rendered,src:a.source_url,width:a.width,height:a.height})}return d.default.createElement("div",{className:[P.default.item,"card",null===t?"":P.default.hasFeaturedImage].join(" "),key:e.id},t,d.default.createElement("div",{className:"card-body"},d.default.createElement("h3",{className:"card-title"},d.default.createElement("a",{href:e.link,dangerouslySetInnerHTML:{__html:e.title.rendered}})),d.default.createElement("date",{dateTime:e.date},h.default.distanceInWords(new Date,e.date,{addSuffix:!0})),d.default.createElement("p",{dangerouslySetInnerHTML:{__html:e.excerpt.rendered}})),d.default.createElement("div",{className:P.default.cardFooter},this.renderPostCategories(e.categories,!!t)))}},{key:"render",value:function(){var e=this;if(!this.state.data[this.state.fetchUrl])return null;var t=null;return!0===this.state.fetching?t=d.default.createElement("div",{className:P.default.ellipsisContainer},d.default.createElement(b.default,null)):this.state.data[this.state.fetchUrl].headers.totalPages>=this.state.data[this.state.fetchUrl].nextPage&&(t=d.default.createElement("div",{className:P.default.buttonContainer},d.default.createElement("button",{className:"btn btn-primary "+P.default.moreButton,onClick:function(){e.fetchPosts()}},"More"))),d.default.createElement("div",{ref:function(t){e.container=t},className:""+P.default.Stories},d.default.createElement("div",{className:P.default.storiesHeader},d.default.createElement("div",{className:P.default.search},d.default.createElement(E.default,{placeholder:"Search the archive",searchTerm:this.state.searchTerm,fetching:!(!this.state.searchTerm.length||!this.state.fetching),handleSearchTermChange:function(t){e.setState({searchTerm:t},e.fetchPosts)}})),d.default.createElement("div",{className:P.default.categories},d.default.createElement("label",{className:P.default.categoryLabel,htmlFor:"categorySelect"},d.default.createElement("span",{className:P.default.categoryLabelText},"Category"),d.default.createElement("select",{id:"categorySelect",value:this.state.activeCategory,onChange:function(t){e.setState({activeCategory:t.target.value})}},d.default.createElement("option",{value:0},"All"),Object.keys(this.state.postCategories).map(function(t){return d.default.createElement("option",{key:t,value:t},e.state.postCategories[t].name)}))))),this.renderBody(),t)}}]),t}(d.default.Component);w.propTypes={endpoint:u.default.string.isRequired,perPage:u.default.string},w.defaultProps={perPage:"12"};var S=function(){Array.prototype.forEach.call(document.querySelectorAll("[data-stories]"),function(e){var t={container:e,endpoint:e.getAttribute("data-endpoint"),perPage:e.getAttribute("data-per-page")||"12"};m.default.render(d.default.createElement(w,t),e)})};t.default=w,t.loadStories=S},function(e,t,a){"use strict";!function(){function t(e){this.className=e&&e.className||"animated-ellipsis",this.style=e&&e.style||void 0,this.spacing=e&&e.spacing||"0.1rem",this.fontSize=e&&e.fontSize||"2rem",this.marginLeft=e&&e.marginLeft||"0.1rem",this.steps=3,this.duration=2,this.perDelay=.2,this.insertStyleNode()}function a(e){var t=e,a=n.steps,r=n.perDelay,o=t.dataset.marginLeft||n.marginLeft,i=t.dataset.spacing||n.spacing;t.style.marginLeft=o,t.style.fontSize=n.fontSize;for(var s=0;s<a;++s){var l=document.createElement("span"),u=s*r;l.className=".$step"+s,l.innerHTML=".";var c="                opacity: 0;                 -webkit-animation: animated-ellipsis "+n.duration+"s infinite;                 animation: animated-ellipsis "+n.duration+"s infinite;                 -webkit-animation-delay: "+u+"s;                 animation-delay: "+u+"s;             ";0!==s&&(c+="margin-left: "+i+";"),l.style.cssText=c,l=t.appendChild(l)}}t.prototype.insertStyleNode=function(){var e=document.createElement("style");e.type="text/css",e.innerHTML="             @-webkit-keyframes animated-ellipsis {                 0%   { opacity: 0; }                 50%  { opacity: 0; }                 100% { opacity: 1; }             }             @keyframes animated-ellipsis {                 0%   { opacity: 0; }                 50%  { opacity: 0; }                 100% { opacity: 1; }             }",this.style=document.getElementsByTagName("head")[0].appendChild(e)};var n=new t;window.HTMLElement.prototype.animateEllipsis=function(){a(this)},window.NodeList.prototype.animateEllipsis=function(){for(var e=0;e<this.length;++e)a(this[e])},window.HTMLElement.prototype.stopAnimatingEllipsis=function(){for(var e=this;e.hasChildNodes();)e.removeChild(e.lastChild);delete e.style.marginLeft},e.exports=n}()},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(){return i.default.createElement("div",{className:l.default.ellipsis},i.default.createElement("span",null,"."),i.default.createElement("span",null,"."),i.default.createElement("span",null,"."))}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var o=a(0),i=n(o),s=a(12),l=n(s)},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(0),o=n(r),i=a(1),s=n(i),l=a(4),u=n(l),c=a(7),d=n(c),f=a(11),m=n(f),p=function(e){var t=e.optionsComponents,a=e.optionsPlacement,n=e.id,r=e.placeholderText,i=e.searchTerm,s=e.handleSearchTermChange,l=e.fetching,c=e.styles;return o.default.createElement("div",{className:c.container},t&&"top"===a?o.default.createElement("div",{className:c.optionsContainer},t):null,o.default.createElement("label",{htmlFor:n,className:c.label},o.default.createElement("span",{className:c["label-name"]},r),o.default.createElement("input",{id:n,className:c.input,placeholder:r,type:"search",value:i,onChange:function(e){s(e.target.value)}}),o.default.createElement("span",{className:c.feedback},!0===l?o.default.createElement(u.default,null):d.default)),t&&"bottom"===a?o.default.createElement("div",{className:c.optionsContainer},t):null)};p.defaultProps={fetching:!1,id:Math.random().toString(36).substr(2,5),optionsComponents:null,optionsPlacement:"bottom",placeholderText:"Search",styles:m.default},p.propTypes={handleSearchTermChange:s.default.func.isRequired,searchTerm:s.default.string.isRequired,fetching:s.default.bool,id:s.default.string,optionsComponents:s.default.arrayOf(s.default.any),optionsPlacement:s.default.oneOf(["top","bottom"]),placeholderText:s.default.string,styles:s.default.objectOf(s.default.any)},t.default=p},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=function(e){return e&&e.__esModule?e:{default:e}}(n);t.default=r.default},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(0),r=function(e){return e&&e.__esModule?e:{default:e}}(n),o=r.default.createElement("svg",{width:"1792",height:"1792",viewBox:"0 0 1792 1792",xmlns:"http://www.w3.org/2000/svg"},r.default.createElement("path",{d:"M1216 832q0-185-131.5-316.5t-316.5-131.5-316.5 131.5-131.5 316.5 131.5 316.5 316.5 131.5 316.5-131.5 131.5-316.5zm512 832q0 52-38 90t-90 38q-54 0-90-38l-343-342q-179 124-399 124-143 0-273.5-55.5t-225-150-150-225-55.5-273.5 55.5-273.5 150-225 225-150 273.5-55.5 273.5 55.5 225 150 150 225 55.5 273.5q0 220-124 399l343 343q37 37 37 90z",fill:"currentColor"}));t.default=o},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":s(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":s(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();a(3);var u=a(0),c=n(u),d=a(1),f=n(d),m=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),l(t,[{key:"componentDidMount",value:function(){this.wrapper.animateEllipsis()}},{key:"componentWillUnmount",value:function(){this.wrapper.stopAnimatingEllipsis()}},{key:"render",value:function(){var e=this,t=this.props,a=t.style,n=t.className,r=t.marginLeft,o=t.spacing,i=t.fontSize;return i&&(a.fontSize=i),c.default.createElement("span",{ref:function(t){return e.wrapper=t},className:n,style:a,"data-margin-left":r,"data-spacing":o})}}]),t}(c.default.Component);m.propTypes={style:f.default.object,className:f.default.string,fontSize:f.default.string,marginLeft:f.default.string,spacing:f.default.string},m.defaultProps={style:{},className:"",fontSize:"2rem",marginLeft:"0.1rem",spacing:"0.1rem"},t.default=m},function(e,t,a){"use strict";e.exports=a(8)},function(e,t,a){"use strict";var n=a(2);window.addEventListener("load",n.loadStories)},function(e,t){e.exports={container:"container",optionsContainer:"optionsContainer",label:"label",feedback:"feedback","label-name":"label-name",input:"input"}},function(e,t){e.exports={ellipsis:"ellipsis",blink:"blink"}},function(e,t){e.exports={Stories:"Stories",column:"column",item:"item",hasFeaturedImage:"hasFeaturedImage",categoriesContainer:"categoriesContainer",categoryButtonContainer:"categoryButtonContainer",categories:"categories",categoryButton:"categoryButton",cardFooter:"cardFooter",storiesHeader:"storiesHeader",categoryLabelText:"categoryLabelText",ellipsisContainer:"ellipsisContainer",buttonContainer:"buttonContainer"}},function(e,t){e.exports=ReactDOM},function(e,t){e.exports=_},function(e,t){e.exports=dateFns}]);